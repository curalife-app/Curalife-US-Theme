{% render 'mini-banner' %}

{% assign current_variant = product.selected_or_first_available_variant %}

<div class="product-data">
    <div class="container">
        <div class="product-wrap">
            <div class="product-slider">
                <div class="discount" style="top:23%;right:65%">
                    {% assign quantity = product.metafields.my_fields.pack_items_quantity %}
                    {% assign quantity_by_cents = quantity | times: 100 %}
                    {% assign item_price = product.price | divided_by: quantity_by_cents | times: 100 %}
                    {% assign original_item_price = product.metafields.my_fields.original_item.value.price %}
                    {% assign original_item_compare_at_price = product.metafields.my_fields.original_item.value.compare_at_price %}

                    {% if quantity > 1 %}
                        <p style="background:#FDD775;border-color:#FDD775;color:black;font-size:20px;margin-top:-10px;">SAVE {{ original_item_compare_at_price | minus: item_price | times: quantity | money_without_trailing_zeros }}</p>
                    {% elsif product.compare_at_price_max > product.price %}
                        <p style="background:#FDD775;border-color:#FDD775;color:black;font-size:20px;margin-top:-10px;">SAVE {{ product.compare_at_price | minus: product.price | money_without_trailing_zeros }}</p>
                    {% endif %}
                </div>
                <div class="sliders-group">
                    <div class="thumbs-slider">
                        <div class="swiper-container">
                            <div class="swiper-wrapper">
                                {% for image in product.images %}
                                    <div class="swiper-slide">
                                        <div class="thumbs-img animate__animated animate__fadeIn">
                                            <div class="img-wrap">
                                                <img data-src="{{ image.src | img_url: 'master' }}" alt="{{ image.alt | escape }}" class="lazyload">
                                            </div>
                                        </div>
                                    </div>
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                    <div class="main-slider">
                        <div class="swiper-container">
                            <div class="swiper-wrapper">
                                {% for image in product.images %}
                                    <div class="swiper-slide">
                                        <div class="product-img" style="display:flex;justify-content:center;">
                                            <img class="product-bg" src="{{ 'easter-product-bg-egg.png' | asset_url }}" alt="" style="position:absolute;top:70px;height:460px;">
                                            <div class="img-wrap img-magnifier-container animate__animated animate__fadeIn" style="display:flex;justify-content:center;padding:11% 0 0;">
                                                <!-- <img class="product-bunny-ears" src="{{ 'easter-product-bunny-ears.png' | asset_url }}" alt=""> -->
                                                <img class="slider-main-img" src="{{ image.src | img_url: 'master' }}" alt="{{ image.alt | escape }}" style="margin-top:-50px;">
                                            </div>
                                        </div>
                                    </div>
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="product-info">
                <div class="sub-title">
                    
                    {% if product.metafields.my_fields.alternative_title.value %}
                    <h1>{{ product.metafields.my_fields.alternative_title.value }}</h1>
                    {% else %}
                    <h1>{{ product.title }}</h1>
                    {% endif %}
                </div>

                <div class="description">
                    <div class="price">
                        {% if product.compare_at_price > product.price %}
                            <p>{{ product.price | money }}
                                <strike>{{ product.compare_at_price | money }}</strike>
                            </p>
                        {% else %}
                            <p>{{ product.price | money }}</p>
                        {% endif %}
                    </div>

                    <div class="form-wrap">
                        <form action="/cart/add" id="addTocartForm" method="post">
                            <div class="input-field product-option-select">
                                <select id="productSelectedVar" {% if option.values.size == 1 %} disabled {% endif %} class="hidden">
                                    {% for v in product.variants %}
                                        <option value="{{v.id}}">{{v.title}}</option>
                                    {% endfor %}
                                </select>
                            </div>

                            <input id="productVaraintSelected" type="hidden" name="id" value="{{ product.variants.first.id }}"/>
                            <div class="qty-data">
                                <p>Quantity</p>
                                <div class="qty-control">
                                    <a data-act="-" href="javascript:void(0)">
                                        <span class="icon-minus"></span>
                                    </a>
                                    <label>
                                        <input maxlength="4" name="quantity" type="number" value="1">
                                    </label>
                                    <a data-act="+" href="javascript:void(0)">
                                        <span class="icon-plus"></span>
                                    </a>
                                </div>
                            </div>

                            <div class="col-md-12 product-page--submit-action" data-stock-email-enabled="{{ section.settings.show_out_of_stock_email }}">
                                {% if product.id == all_products["curalin"].id or product.id == all_products["curalin-3-pack"].id %}
                                    <div class="btn">
                                        {% if pick_an_option or current_variant.available %}
                                            <button class="main-btn " id="AddTCart" name="add" type="submit">
                                                <i class="icon-cart"></i>Add to Cart</button>
                                        {% else %}
                                            <button class="main-btn" id="" name="add" type="button">
                                                <i class="icon-cart"></i>
                                                {{ 'products.product.sold_out' | t }}</button>
                                            {{ 'products.product.sold_out' | t }}
                                        {% endif %}

                                    </div>
                                {% else %}
                                    <div class="btn">
                                        <button class="main-btn" id="AddTCart" name="add" type="submit">
                                            <i class="icon-cart"></i>Add to Cart</button>
                                    </div>
                                {% endif %}
                            </div>
                        </form>

                        <div class="shipping-label">
                            <p>
                                <span class="{{section.settings.ship_icn}}"></span>
                                {{section.settings.ship_txt}}</p>
                        </div>
                    </div>

                    {% for block in section.blocks %}
                        {% if block.type == 'prdct_tabs' %}
                            <div class="ex_peras">
                                <div class="text-wrap">
                                    <p class="des_pera">{{block.settings.tab_des}}</p>
                                </div>
                            </div>
                        {% endif %}
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    .product-slider:before {
        background: unset;
    }

    .main-btn {
        background-color: #01C6B2;
        border-color: #01C6B2;
    }

    .main-btn:hover {
        background-color: #009d8d;
        border-color: #009d8d;
    }

    .product-slider .main-slider .product-img .img-wrap img.product-bunny-ears {
        position: absolute;
        z-index: -1;
        top: -10px;
        margin-left: 37px;
        width: unset;
        height: unset;
    }

    @media screen and (max-width:1590px) {
        .product-bg {
            max-height: 27vw;
        }

        .main-slider .swiper-container {
            min-height: 40vw;
        }
    }

    @media screen and (max-width:1270px) {
        .product-bg {
            max-height: 28vw;
        }

        /* .product-bunny-ears {
            max-height: 15vw;
        } */
    }

    @media screen and (max-width:760px) {
        .main-slider .swiper-container {
            min-height: unset;
        }

        .product-slider .discount p {
            padding: 4px 13px;
            font-size: 16px !important;
        }

        .product-slider .sliders-group:before {
            background: unset;
        }

        .product-slider .main-slider .product-img .img-wrap {
            padding: 70px 0px 0px 0px;
        }

        .product-bg {
            height: 80vw !important;
        }

        /* .product-bunny-ears {
            height: 35vw !important;
            margin-left: 6vw !important;
            margin-top: 2vw !important;
            max-height: unset;
        } */

        .slider-main-img {
            height: 70vw;
            margin-top: 14vw;
        }

        .product-bg {
            max-height: unset;
        }
    }
</style>

<script>
  // Change Quantity Widget On Product Page
  $(document).on("click", ".product-data .qty-control a", function (e) {
        e.preventDefault();
        let newVal, $button = $(this),
            inputObj = $button.closest(".qty-control").find("input"),
            oldValue = inputObj.val();
        if ($button.attr('data-act') === "+") {
            newVal = parseInt(oldValue) + 1;
        } 
        else {
            newVal = parseInt(oldValue) - 1;
        }

        inputObj.val(newVal);
    });
</script>

<script>
  $(document).on("click", "#AddTCart", function () {
  window.dataLayer  = window.dataLayer || [];
  window.dataLayer.push({
    'event': 'eec.addToCart',       // name of an event. In this case, always stays as eec.addToCart
    'ecommerce': {                  // ecommerce object. This is the essential part of tracking. New EE data must always be pushed to this object
    'currencyCode': '{{shop.currency }}',          // the currency which is currently used by a visitor
    'add': {                        // name of an action. In this case, always stays as add
      'actionField': {           
      'list': 'main'          // optional. name of a list from which the product was added to a cart  
      },       
      'products': [{              // list of products added to a cart. Can contain multiple products at the same time
      'name': '{{ product.title }}',      // name of a product that was added to a cart
      'id': '{{ product.id }}',       // id of a product
      'price': '{{ current_variant.price | money_without_currency }}',      // price of a product
      'category': 'Simple',
      'variant': '{{ product.first_available_variant.id }}',   // category of a product
      'quantity': 1
      }]
    } 
    },
    'userId': '{{ customer.id }}',
    'email': '{{ customer.email }}',
    'country': '{{customer.customer_address.country_code }}',
    'city': '{{customer.customer_address.city }}',
    'name': '{{ customer.first_name }}',
    'surname': '{{ customer.last_name }}',
    'phone_number': '{{customer.phone }}',
    'state': '{{customer.customer_address.province }}',       //state or province
    'zip': '{{customer.customer_address.zip }}'         //ZIP or Postal code
    });

  // New One
    window.dataLayer = window.dataLayer || [];
window.dataLayer.push({
  event: 'add_to_cart',    
  ecommerce: {                          
  items: [{       
    item_name: '{{ product.title }}',      
    item_id: '{{ product.selected_or_first_available_variant.sku }}', 
    affiliation: '{{ shop.name }}',
    price: '{{ product.selected_or_first_available_variant.price | money_without_currency }}',
    currency: '{{ shop.currency }}',
    item_brand: 'CuraLife',            
    item_category: 'CuraLin',         
    quantity: parseInt($(".qty-control input").val())
  }]
  },
  user_email: '{{ customer.email }}',
  user_phone: '{{ customer.phone }}',
  user_first_name: '{{ customer.first_name }}',
  user_last_name: '{{ customer.last_name }}',
  user_city: '{{ customer.customer_address.city }}',
  user_state: '{{ customer.customer_address.province }}',
  user_zip: '{{ customer.customer_address.zip }}',
  user_country: '{{customer.customer_address.country_code | t}}',
  user_agent: navigator.userAgent
  //user_ip_address: 'insert_ip_address_here',
});
  });
</script>

<script>
  $(document).on("click", "#AddToCart", function (Event) {
    $("#cart-upgrade-popup").slideToggle();
    return false;
  });

  // Old One
  window.dataLayer = window.dataLayer || [];
  window.dataLayer.push({
  'event': 'eec.productDetail',  // name of an event. In this case, always stays as eec.productDetail
  'ecommerce': {                      // ecommerce object. This is the essential part of tracking. New EE data must always be pushed to this object
    'currencyCode': '{{shop.currency}}',           
    'detail': { // name of an action. In this case, always stays as detail
      'products': [{
      'name': '{{product.title}}',      // name of a product that is currently viewed. Always include it.
      'id': '{{ product.id }}',           // id of a product. Always include it.
      'price': '{{ product.selected_or_first_available_variant.price | money_without_currency }}',          // price of a product
      'category': 'Simple',      // category of a product
      'variant': '{{ product.selected_variant.id }}'         // product variant.
      }]
      }
  },
  'userId': '{{ customer.id }}',
  'email': '{{ customer.email }}',
  'country': '{{customer.customer_address.country_code | t}}',
  'city': '{{customer.customer_address.city }}',
  'name': '{{ customer.first_name }}',
  'surname': '{{ customer.last_name }}',
  'phone_number': '{{customer.phone }}',
  'state': '{{customer.customer_address.province }}',       //state or province
  'zip': '{{customer.customer_address.zip }}'         //ZIP or Postal code         
  });

  // New One
  {% if product.compare_at_price > product.price %} {% assign discount_amount = product.compare_at_price | minus: product.price %} {% else %} {% assign discount_amount = 0 %} {% endif %}
window.dataLayer = window.dataLayer || [];
window.dataLayer.push({
  event: 'view_item',         
  ecommerce: {                          
  items: [{        
    item_name: '{{ product.title }}',      
    item_id: '{{ product.selected_or_first_available_variant.sku }}', 
    affiliation: '{{ shop.name }}',
    price: '{{ product.selected_or_first_available_variant.price | money_without_currency }}',
    currency: '{{ shop.currency }}',
    item_brand: 'CuraLife',            
    item_category: 'CuraLin',         
    quantity: 1
  }]
  },
  user_email: '{{ customer.email }}',
  user_phone: '{{ customer.phone }}',
  user_first_name: '{{ customer.first_name }}',
  user_last_name: '{{ customer.last_name }}',
  user_city: '{{ customer.customer_address.city }}',
  user_state: '{{ customer.customer_address.province }}',
  user_zip: '{{ customer.customer_address.zip }}',
  user_country: '{{customer.customer_address.country_code | t}}',
  user_agent: navigator.userAgent
  //user_ip_address: 'insert_ip_address_here',
});
</script>

<script>
var _learnq = _learnq || [];

  var item = {
  Name: {{ product.title|json }},
  ProductID: {{ product.id|json }},
  Categories: {{ product.collections|map:'title'|json }},
  ImageURL: "https:{{ product.featured_image.src|img_url:'grande' }}",
  URL: "{{ shop.secure_url }}{{ product.url }}",
  Brand: {{ product.vendor|json }},
  Price: {{ product.price|money|json }},
  CompareAtPrice: {{ product.compare_at_price_max|money|json }}
  };

  _learnq.push(['track', 'Viewed Product', item]);
  _learnq.push(['trackViewedItem', {
  Title: item.Name,
  ItemId: item.ProductID,
  Categories: item.Categories,
  ImageUrl: item.ImageURL,
  Url: item.URL,
  Metadata: {
    Brand: item.Brand,
    Price: item.Price,
    CompareAtPrice: item.CompareAtPrice
  }
  }]);

</script>

{% schema %}

{
    "name": "Proudct",
    "class": "cart-content",
    "settings": [
        {
            "type": "textarea",
            "id": "prd_descript",
            "label": "Description",
            "default": "Add Description "
        }, {
            "type": "text",
            "id": "prd_icn",
            "label": "Add Icon",
            "default": "icon-afterpay"
        }, {
            "type": "text",
            "id": "prd_text",
            "label": "Button Title",
            "default": "Add Button Title "
        }, {
            "type": "url",
            "id": "prd_url",
            "label": "Button URL"
        }, {
            "type": "text",
            "id": "ship_txt",
            "label": "Shipping Title",
            "default": "Add Shipping Title"
        }, {
            "type": "text",
            "id": "ship_icn",
            "label": "Shipping Icon",
            "default": "icon-shipping"
        }, {
            "type": "header",
            "content": "Upgrade Popup"
        }, {
            "type": "textarea",
            "id": "first_up_title",
            "label": "3-pack Title"
        }, {
            "type": "textarea",
            "id": "first_up_text",
            "label": "3-pack Text"
        }, {
            "type": "text",
            "id": "first_btnup_text",
            "label": "3-pack Btn"
        }, {
            "type": "textarea",
            "id": "second_up_title",
            "label": "6-pack Title"
        }, {
            "type": "textarea",
            "id": "second_up_text",
            "label": "6-pack Text"
        }, {
            "type": "text",
            "id": "second_btnup_text",
            "label": "6-pack Btn"
        }, {
            "type": "text",
            "id": "continue_btn_text",
            "label": "Continue Btn"
        }
    ],
    "blocks": [
        {
            "type": "prdct_tabs",
            "name": "Product Tabs",
            "settings": [
                {
                    "type": "textarea",
                    "id": "tab_des",
                    "label": "Tab Description",
                    "default": "Enter Tab Description"
                }
            ]
        }
    ]
}

{% endschema %}

{% stylesheet %}
.hidden{
    visibility: hidden;
    position: absolute;
}
{% endstylesheet %}