<div class="cart-page">
    <div class="container">
        <div class="mini-wrap">
          {% if cart.item_count > 0 %}
            <div class="page-title">
                <div class="sub-title">
                    <h1>{{section.settings.crt_titl}}</h1>
                </div>
               
            </div>
            <form action="{{ routes.cart_url }}" method="post" novalidate class="cart table-wrap" id="cartform" data-wetheme-section-type="template--cart" data-wetheme-section-id="{{ section.id }}">
            <div class="cart-list">
                <table>
                    <thead>
                    <tr>
                        <th></th>
                        <th>Name</th>
                        <th>Price</th>
                        <th>Quantity</th>
                        <th>Total</th>
                    </tr>
                    </thead>
                    <tbody>
                    {% for item in cart.items %}
                    <tr>
                        <td class="img">
                            <div class="img-wrap">
                                <span><img src="{{ item | img_url: 'medium' }}" alt="{{ item.title | escape }}"></span>
                            </div>
                        </td>
                        <td class="name">
                            {% if item.product.metafields.my_fields.alternative_title.value %}
                          <p>{{ item.product.metafields.my_fields.alternative_title.value }}</p>
                          {% else %}
                          <p>{{ item.product.title }}</p>
                          {% endif %}
                            <div class="remove-item" data-variant="{{item.variant.id}}" data-price ="{{ item.original_price | money }}" data-title="{{ item.product.title }}" data-id="{{ item.product.id }}">
                                <a href="/cart/change?line={{ forloop.index }}&amp;quantity=0">Remove</a>
                            </div>
                        </td>
                        <td class="price"><p>{{ item.price | money }}</p></td>
                        <td class="quantity">
                            <div class="qty-data">
                                <p>Quantity</p>
                                <div class="qty-control">
                                    <a class="decrease-quantity" href="javascript:void(0)" data-act="-"><span class="icon-minus"></span></a>
                                    <label>
                                        <input type="number" name="updates[]" value="{{ item.quantity }}" maxlength="4">
                                    </label>
                                    <a class="increase-quantity" href="javascript:void(0)" data-act="+"><span class="icon-plus"></span></a>
                                </div>
                            </div>
                        </td>
                        <td class="total"><p>{{ item.original_line_price | money }} <strike>{{ product.compare_at_price | money }}</strike></p></td>
                    </tr>
                     {% endfor %}
                    </tbody>
                </table>
            </div>
            <div class="cart-total">
                <div class="total-wrap">
                    <div class="price">
                        <p>Subtotal: <b>{{ cart.total_price | money }}</b></p>
                    </div>
                    <div class="btn-wrap">
                      <input id="cart_submit" type="submit" value="Place your order" name="checkout" class="main-btn" />
                      <input id="update_quantities" type="submit" value="Update Cart" title="{{ 'cart.general.update' | t }}" name="update" class="main-btn blank" />
                    </div>
                   
                </div>
            </div>
          </form>
          {% else %}
          <div class="emty_crt">
              <h2>Your cart is currently empty.</h2>
              <a href="https://curalife.com/collections/all" class="main-btn">Continue shopping</a>
          </div>
            {% endif %}
        </div>
    </div>
</div>

{% schema %}
  {
    "name": "Cart",
    "class": "cart-content",
    "settings": [ 
      {
        "type": "text",
        "id": "crt_titl",
        "label": "Title",
        "default": "Add Title "   
      },
      {
        "type": "textarea",
        "id": "crt_descript",
        "label": "Description",
        "default": "Add Description "   
      },
      {
        "type": "text",
        "id": "crt_icn",
        "label": "Add Icon",
        "default": "icon-afterpay"   
      },
      {
        "type": "text",
        "id": "btn_text",
        "label": "Button Title",
        "default": "Add Button Title "   
      },
       {
        "type": "url",
        "id": "btn_url",
        "label": "Button URL"
        
      }
    ] 
        
    }
{% endschema %}

{% stylesheet %}
{% endstylesheet %}

{% javascript %}
{% endjavascript %}
<style>
    body{
        overflow-x: hidden;
    }
  .emty_crt .main-btn {
    max-width: 260px;
}
.emty_crt{
    text-align: center;
   margin-top: 50px;
}
p.afterpay-paragraph {
    position: relative;
    top: 80px;
    text-align: left !important;
}

input#update_quantities {
    bottom: 40px;
}
input#cart_submit {
    width: 100%;
}
input#update_quantities {
    width: 100%;
}
</style>

<script type="text/javascript">
  cart_data = {{ cart | json}};
  var items_data = cart_data.items.map(function(item){
      return {
        item_id: item.id,
		    item_name: item.product_title,
        affiliation: '{{ shop.name }}',
        price: parseFloat(item.price / 100.0),
        currency: '{{ shop.currency }}',
        discount: item.compare_at_price > 0 ? parseFloat(item.compare_at_price / 100.0) - parseFloat(item.price / 100.0) : 0,
        item_brand: 'CuraLife',            
        item_category: 'CuraLin',         
        quantity: item.quantity 
        }
      });

  window.dataLayer = window.dataLayer || [];
window.dataLayer.push({
  event: 'view_cart',           // name of the event. In this case, it always must be view_cart
  ecommerce: {                          
    items: items_data
  },
  user_email: '{{ customer.email }}',
  user_phone: '{{ customer.phone }}',
  user_first_name: '{{ customer.first_name }}',
  user_last_name: '{{ customer.last_name }}',
  user_city: '{{ customer.customer_address.city }}',
  user_state: '{{ customer.customer_address.province }}',
  user_zip: '{{ customer.customer_address.zip }}',
  user_country: '{{customer.customer_address.country_code | t}}',
  user_agent: navigator.userAgent
  //user_ip_address: 'insert_ip_address_here',
});
</script>

<script>
  jQuery(".increase-quantity").click(function() {
window.dataLayer = window.dataLayer || [];
window.dataLayer.push({
event: 'add_to_cart',    
ecommerce: {                          
items: [{       
item_name: $(this).attr("title"),      
item_id: $(this).attr("prod-id"), 
affiliation: '{{ shop.name }}',
price: $(this).attr("price"),
currency: '{{ shop.currency }}',
discount: $(this).attr("discount"),
item_brand: 'CuraLife',            
item_category: 'CuraLin',         
quantity: '1'                   
}]
},
user_email: '{{ customer.email }}',
user_phone: '{{ customer.phone }}',
user_first_name: '{{ customer.first_name }}',
user_last_name: '{{ customer.last_name }}',
user_city: '{{ customer.customer_address.city }}',
user_state: '{{ customer.customer_address.province }}',
user_zip: '{{ customer.customer_address.zip }}',
user_country: '{{customer.customer_address.country_code | t}}',
user_agent: navigator.userAgent
//user_ip_address: 'insert_ip_address_here',
});
  })

  jQuery(".decrease-quantity").click(function() {
      window.dataLayer = window.dataLayer || [];
window.dataLayer.push({
  event: 'remove_from_cart',    
  ecommerce: {                          
    items: [{       
        item_name: $(this).attr("title"),      
        item_id: $(this).attr("prod-id"), 
        affiliation: '{{ shop.name }}',
        price: $(this).attr("price"),
        currency: '{{ shop.currency }}',
        discount: $(this).attr("discount"),
        item_brand: 'CuraLife',            
        item_category: 'CuraLin',         
        quantity: '1'                   
    }]
  },
  user_email: '{{ customer.email }}',
  user_phone: '{{ customer.phone }}',
  user_first_name: '{{ customer.first_name }}',
  user_last_name: '{{ customer.last_name }}',
  user_city: '{{ customer.customer_address.city }}',
  user_state: '{{ customer.customer_address.province }}',
  user_zip: '{{ customer.customer_address.zip }}',
  user_country: '{{customer.customer_address.country_code | t}}',
  user_agent: navigator.userAgent
  //user_ip_address: 'insert_ip_address_here',
});
          })

          jQuery(".remove-item a").click(function() {
      window.dataLayer = window.dataLayer || [];
window.dataLayer.push({
  event: 'remove_from_cart',    
  ecommerce: {                          
    items: [{       
        item_name: $(this).parent().attr("data-title"),      
        item_id: $(this).parent().attr("data-id"), 
        affiliation: '{{ shop.name }}',
        price: $(this).parent().attr("data-price"),
        currency: '{{ shop.currency }}',
        discount: $(this).parent().attr("data-discount"),
        item_brand: 'CuraLife',            
        item_category: 'CuraLin',         
        quantity: $(this).parent().attr("data-quantity")                  
    }]
  },
  user_email: '{{ customer.email }}',
  user_phone: '{{ customer.phone }}',
  user_first_name: '{{ customer.first_name }}',
  user_last_name: '{{ customer.last_name }}',
  user_city: '{{ customer.customer_address.city }}',
  user_state: '{{ customer.customer_address.province }}',
  user_zip: '{{ customer.customer_address.zip }}',
  user_country: '{{customer.customer_address.country_code | t}}',
  user_agent: navigator.userAgent
  //user_ip_address: 'insert_ip_address_here',
});
          })
</script>