<script>
  const detectRobot = (userAgent) => {
    const robots = new RegExp([
      /bot/, /spider/, /crawl/,
      /APIs-Google/, /AdsBot/, /Googlebot/,
      /mediapartners/, /Google Favicon/,
      /FeedFetcher/, /Google-Read-Aloud/,
      /DuplexWeb-Google/, /googleweblight/,
      /bing/, /yandex/, /baidu/, /duckduck/, /yahoo/,
      /ecosia/, /ia_archiver/,
      /facebook/, /instagram/, /pinterest/, /reddit/,
      /slack/, /twitter/, /whatsapp/, /youtube/,
      /semrush/,
    ].map((r) => r.source).join("|"), "i");
    return robots.test(userAgent);
  };

  function redirectTo(url) {
    window.location.hostname = url;
  }

  const userAgent = navigator.userAgent;
  const isRobot = detectRobot(userAgent);

  if (!isRobot) {
    console.log('REDIRECTING...');
    let req = new XMLHttpRequest;
    req.overrideMimeType("application/json"), req.open("GET", "https://geo.curalife.com/", !0), req.onload = function() {
      let country = JSON.parse(req.responseText).country;
      let host = location.hostname == "global.curalife.com" ? "Global" : "USA";
      let countries = ["US", "PR", "CA", "AU"]; // Countries for main domain (USA)
      sessionStorage.setItem('country', country);

      if ((host == "USA") && (!countries.includes(country))) { // If US and not US or PR so go Global
        redirectTo("global.curalife.com")
      }
      else if ((host == "Global") && (countries.includes(country)) { // If Global and we are on US or PR so go US
        redirectTo("curalife.com");
      }
      else if (country == "AT") {redirectTo("curalife.at")} // If Austria
      else if (country == "KW") {redirectTo("trycuralife.com")} // If Kuwait
    }, req.send(null);
  }
</script>