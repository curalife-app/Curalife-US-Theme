
<section class="cta-section">
  <div class="container product-container">
    <div class="product-thumbnails">
      <div class="product-slider">
        <div class="sliders-group">
          <div class="main-slider">
            <div id="product-main-slider-sc" class="swiper">
              <div class="swiper-wrapper">
                {% assign imagesCounter = 0 %}
                {% for i in (1..6) %}
                  {% assign imagesCounter = imagesCounter | plus: 1 %}
                  <div class="swiper-slide">
                  {% unless forloop.index == 1 %}<img class="main-slider-vector-bg" src="{{ 'product-aio-vector-product-slider.png' | asset_url }}" width="534" height="342" alt="">{% endunless %}
                    <div class="product-img">
                      <div class="img-wrap">
                        <img src="{{ "product-aio-product-thumbnail-" | append: i | append: ".png" | asset_url }}" width="588" height="453" alt="" loading="lazy">
                      </div>
                    </div>
                  </div>
                {% endfor %}

                <div class="swiper-slide">
                  <div class="product-video">
                    <iframe id="product-video-iframe" src="https://player.vimeo.com/video/365492409?playsinline=0" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen loading="lazy"></iframe>
                  </div>
                </div>

                {% for image in product.images %}
                  <div class="swiper-slide">
                    {% if shop.name == "CuraLife Global" %}
                      <img class="main-slider-vector-bg" src="{{ 'product-aio-vector-product-slider.png' | asset_url }}" width="534" height="342" alt="">
                    {% endif %}

                    <div class="product-img">
                      <div class="img-wrap">
                        <img src="{{ image.src | image_url }}" alt="{{ image.alt | escape }}" width="1176" height="905" loading="lazy">
                      </div>
                    </div>
                  </div>
                {% endfor %}
              </div>

              <div class="swiper-pagination"></div>
            </div>

            <div id="product-main-slider-nav-prev" class="swiper-button-prev nav"></div>
            <div id="product-main-slider-nav-next" class="swiper-button-next nav"></div>
          </div>

          <div class="thumbs-slider">
            <div id="product-thumbs-slider-sc" class="swiper">
              <div class="swiper-wrapper">
                {% for i in (1..6) %}
                  <div class="swiper-slide">
                    <div class="thumbs-img">
                      <div class="img-wrap">
                        <img src="{{ "product-aio-product-thumbnail-" | append: i | append: ".png" | asset_url }}" width="588" height="453" alt="" loading="lazy">
                      </div>
                    </div>
                  </div>
                {% endfor %}

                <div class="swiper-slide">
                  <div class="thumbs-img video-thumbnail">
                    <div class="img-wrap">
                      <img src="{{ "product-aio-product-video-thumbnail.png" | asset_url }}" width="720" height="680" alt="" loading="lazy">
                    </div>
                  </div>
                </div>

                {% for image in product.images %}
                  <div class="swiper-slide">
                    <div class="thumbs-img">
                      <div class="img-wrap">
                        <img src="{{ image.src | image_url }}" alt="{{ image.alt | escape }}" loading="lazy">
                      </div>
                    </div>
                  </div>
                {% endfor %}
              </div>
            </div>

            <div id="product-thumbs-slider-nav-prev" class="swiper-button-prev"></div>
            <div id="product-thumbs-slider-nav-next" class="swiper-button-next"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="product-info">
      <h1>{% if product.metafields.my_fields.alternative_title.value %}{{ product.metafields.my_fields.alternative_title.value }}{% else %}{{ product.title }}{% endif %}</h1>

      {% render 'product-all-in-one-cta-section-reviews' %}
    </div>

    {% render 'product-all-in-one-cta-section-actions', product: product %}
  </div>

  {% render 'trust-badges-section', colors: "#5c5c5c", bottomLine: true %}
</section>

<style>
  section {
    padding: 50px 0
  }

  .cta-section .product-container {
    display: grid;
    grid-template-columns: 60% 40%;
    grid-column-gap: 0;
    grid-row-gap: 0;
  }

  .cta-section .product-container .product-thumbnails {
    grid-area: 1/1/3/2;
  }

  .cta-section .product-container .product-thumbnails .product-slider {
    width: unset !important;
    padding: unset;
  }

  .cta-section .product-container .product-thumbnails .product-slider .main-slider {
    padding: unset;
    margin-left: unset
  }

  .cta-section .product-container .product-thumbnails .product-slider .main-slider .main-slider-vector-bg {
    position: absolute;
    margin-left: 10%
  }

  .cta-section .product-container .product-thumbnails .product-slider .main-slider .swiper-slide .product-img-aio:before {
    padding-bottom: 60%
  }

  .cta-section .product-container .product-thumbnails .product-slider .main-slider .swiper-slide .product-img-aio .img-wrap {
    padding: unset;
    text-align: center
  }

  .cta-section .product-container .product-thumbnails .product-slider .main-slider .swiper-slide .product-img-aio .img-wrap img {
    max-height: 460px
  }

  .cta-section .product-container .product-thumbnails .product-slider .main-slider .swiper-slide .product-video iframe {
    height: 400px;
    width: 100%
  }

  .cta-section .product-container .product-thumbnails .product-slider .main-slider .nav {
    display: none;
  }

  .cta-section .product-container .product-thumbnails .product-slider .thumbs-slider {
    position: relative;
    display: flex;
    margin-top: 30px;
    width: 95%;
    margin-left: auto;
    margin-right: auto;
    padding-left: 3em;
    padding-right: 3em;
  }

  .cta-section .product-container .product-thumbnails .product-slider .thumbs-slider .swiper-wrapper .thumbs-img {
    border-radius: unset;
    width: 120px;
    height: 120px;
    border-radius: 5px;
  }

  .cta-section .product-container .product-info {
    padding: unset;
    width: unset;
    max-width: 450px;
    grid-area: 1/2/2/3;
  }

  .cta-section .product-container .product-info h1 {
    font-weight: 600;
    font-size: 40px;
  }

  .swiper-button-prev,
  .swiper-button-next {
    color: gray;
    transition: opacity .5s;
  }

  .swiper-button-prev.disabled,
  .swiper-button-next.disabled {
    opacity: 0;
  }

  .product-template-all-in-one .swiper-button-prev::after,
  .product-template-all-in-one .swiper-button-next::after {
    font-size: 28px;
  }

  .variant-notice p {
    background: #9EB069;;
    color: white;
    padding: 4px;
    margin: unset;
  }

  @media screen and (max-width: 1270px) {
    .container {
      max-width: unset;
      padding: 0 20px;
    }
  }

  @media screen and (max-width: 768px) {
    section {
      padding: 8vw 0;
    }

    .container {
      padding: 0 20px !important;
    }

    .cta-section {
      padding-top: 70px;
      padding-bottom: 0;
    }

    .cta-section .product-container {
      grid-template-columns: repeat(1, 100%);
      grid-template-rows: unset;
      padding: 0 20px 20px;
    }

    .cta-section .product-container .product-thumbnails {
      grid-area: unset;
      grid-row: 2;
    }

    .cta-section .product-container .product-thumbnails .product-slider {
      margin-left: unset;
    }

    .cta-section .product-container .product-thumbnails .product-slider .main-slider {
      width: 95%;
      margin: auto
    }

    .cta-section .product-container .product-thumbnails .product-slider .main-slider .main-slider-vector-bg {
      margin-left: unset;
      left: 0;
      top: 10%;
    }

    .cta-section .product-container .product-thumbnails .product-slider .main-slider .swiper-wrapper {
      margin-bottom: 30px;
      align-items: center
    }

    .cta-section .product-container .product-thumbnails .product-slider .main-slider .swiper-wrapper .swiper-slide .product-video iframe {
      height: 45vh
    }

    .cta-section .product-container .product-thumbnails .product-slider .main-slider .swiper-wrapper .swiper-slide .product-video iframe .vp-video-wrapper {
      border-radius: 10px;
    }

    .cta-section .product-container .product-thumbnails .product-slider .main-slider .swiper-wrapper .swiper-slide .product-img::before {
      padding-bottom: 100%
    }

    .cta-section .product-container .product-thumbnails .product-slider .main-slider .nav {
      display: block;
    }

    .cta-section .product-container .product-thumbnails .product-slider .main-slider .nav.swiper-button-prev {
      left: 0;
    }

    .cta-section .product-container .product-thumbnails .product-slider .main-slider .nav.swiper-button-next {
      right: 0
    }

    .cta-section .product-container .product-thumbnails .product-slider .main-slider .swiper-pagination .swiper-pagination-bullet {
      background: var(--green);
      opacity: .4;
      width: 13px;
      height: 13px;
      border: 0;
    }

    .cta-section .product-container .product-thumbnails .product-slider .main-slider .swiper-pagination .swiper-pagination-bullet.swiper-pagination-bullet-active {
      background: var(--green);
      opacity: 1
    }

    .cta-section .product-container .product-thumbnails .product-slider .thumbs-slider {
      display: none
    }

    .cta-section .product-container .product-info {
      grid-area: unset;
      grid-row: 1;
      text-align: center;
      padding: 0 20px;
      max-width: unset
    }

    .cta-section .product-container .product-actions {
      grid-area: unset;
      grid-row: 3;
      max-width: unset
    }
  }

  @media screen and (max-width: 330px) {
    .cta-section .variant-infos {
      font-size: 10px !important;
    }
  }
</style>

<script>
  productThumbsAllInOne = new Swiper('#product-thumbs-slider-sc', {
    slidesPerView: 4,
    spaceBetween: 10,
    watchSlidesVisibility: true,
    grabCursor: true,
    loop: false,
    navigation: {
      nextEl: '#product-thumbs-slider-nav-next',
      prevEl: '#product-thumbs-slider-nav-prev',
      disabledClass: 'disabled'
    },
    breakpoints: {
      760: {
        slidesPerView: 1,
      },
      1080: {
        slidesPerView: 2,
      },
      1200: {
        slidesPerView: 3,
      },
      1400: {
        slidesPerView: 4,
      }
    }
  });

  productSliderAllInOne = new Swiper('#product-main-slider-sc', {
    slidesPerView: 1,
    spaceBetween: 15,
    centeredSlides: true,
    watchSlidesVisibility: false,
    loop: false,
    slideToClickedSlide: true,
    thumbs: {swiper: productThumbsAllInOne},
    breakpoints: {
      0: {
        pagination: {
          el: '.product-slider .swiper-pagination',
          clickable: 'true',
          type: 'bullets',
        },
        navigation: {
          nextEl: '#product-main-slider-nav-next',
          prevEl: '#product-main-slider-nav-prev',
          disabledClass: 'disabled'
        }
      },
      760: {
        pagination: {},
        navigation: {}
      }
    }
  });
</script>

<script>
  $( document ).ready(function() {
    updateSave();
  });

  function updateSave() {
    let saveText = "You Save " + "{{ cart.currency.symbol }}" + $('input[name=pack]:checked', '#CTAForm').attr('discount');

    $('#save').animate({'opacity': 0}, 800, function () {
      $(this).text(saveText);
    }).animate({'opacity': 1}, 800);
  }

  /*Slide to Variant Image*/
  productSliderAllInOne.on('slideChange', function () {
    $('iframe#product-video-iframe').attr( 'src', function ( i, val ) { return val; });
  });

  $(".variant-box").click(function() {
    updateSave();

    $(this).find('input[type=radio]').prop('checked', true);
    $("#productVaraintSelected").prop('value', $(this).find('input[type=radio]')[0].value);

    /*Slide to Variant Image*/
    let slideIndex = productSliderAllInOne.slides.length - jQuery('input[name=pack]:checked', '#CTAForm').attr('index');
    productSliderAllInOne.slideTo(slideIndex);

    // Track in GA
    window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
      'event': 'variant-click',
      'label': $('input[name=pack]:checked', '#CTAForm').attr('sku'),
      'userId': '{{ customer.id }}',
      'email': '{{ customer.email }}',
      'country': '{{customer.customer_address.country_code }}',
      'city': '{{customer.customer_address.city }}',
      'name': '{{ customer.first_name }}',
      'surname': '{{ customer.last_name }}',
      'phone_number': '{{customer.phone }}',
      'state': '{{customer.customer_address.province }}',       //state or province
      'zip': '{{customer.customer_address.zip }}'         //ZIP or Postal code
    });

    // Track in Woopra
    woopra.track('Product_Variant_Select', {
      sku: $(this).find("input").attr("sku"),
      variant_id: $(this).find("input").attr("value"),
      variant_title: $(this).find("input").attr("title"),
      price: $(this).find("input").attr("price")
    })
  });

  // Change Quantity Widget On Product Page
  $(document).on("click", ".submit-wrap .qty-control a", function (e) {
    e.preventDefault();
    let newVal, $button = $(this),
      inputObj = $button.closest(".qty-control").find("input"),
      oldValue = inputObj.val();
    if ($button.attr('data-act') === "+") {
      newVal = parseInt(oldValue) + 1;
    }
    else {
      newVal = parseInt(oldValue) - 1;
    }

    inputObj.val(newVal);
  });

  $('.thumbs-img').click(function() {
    woopra.track('Product Image Click', {});
  });

  // Buy Button Functionality
  $("#buy-button").click(function() {
    let checkedPack = $('input[name=pack]:checked', '#CTAForm').val();
    let checkedQuantity = $('input[name=quantity]', '#CTAForm').val();
    let checkoutLink = "https://" + location.hostname + "/cart/" + checkedPack + ":" + checkedQuantity;
    window.location.href = checkoutLink;
  })
</script>

<script>
  $(document).on("click", "#buy-button", function () {
    window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
      event: 'add_to_cart',
      ecommerce: {
      items: [{
        item_name: '{{ product.title }}',
        item_id: $('input[name=pack]:checked', '#CTAForm').attr('sku'),
        affiliation: '{{ shop.name }}',
        price: $('input[name=pack]:checked', '#CTAForm').attr('price'),
        currency: '{{ shop.currency }}',
        item_brand: 'CuraLife',
        item_category: 'CuraLin',
        quantity: parseInt($(".qty-control input").val())
      }]
      },
      email: '{{ customer.email }}',
      phone: '{{ customer.phone }}',
      name: '{{ customer.first_name }}',
      surname: '{{ customer.last_name }}',
      city: '{{ customer.customer_address.city }}',
      state: '{{ customer.customer_address.province }}',
      zip: '{{ customer.customer_address.zip }}',
      country: '{{customer.customer_address.country_code | t}}',
      user_agent: navigator.userAgent
    });

    woopra.track('add to cart', {
      product_sku: $('input[name=pack]:checked', '#CTAForm').attr('sku'),
      product_name: '{{ product.title }}',
      product_price: $('input[name=pack]:checked', '#CTAForm').attr('price'),
      currency: '{{ shop.currency }}',
      quantity: parseInt($(".qty-control input").val())
    });
  });

  window.dataLayer = window.dataLayer || [];
  window.dataLayer.push({
    event: 'view_item',
    ecommerce: {
      items: [{
        item_name: '{{ product.title }}',
        item_id: '{{ product.title }}',
        affiliation: '{{ shop.name }}',
        price: '',
        currency: '{{ shop.currency }}',
        item_brand: 'CuraLife',
        item_category: 'CuraLin',
        quantity: 1
      }]
    },
    email: '{{ customer.email }}',
    phone: '{{ customer.phone }}',
    name: '{{ customer.first_name }}',
    surname: '{{ customer.last_name }}',
    city: '{{ customer.customer_address.city }}',
    state: '{{ customer.customer_address.province }}',
    zip: '{{ customer.customer_address.zip }}',
    country: '{{customer.customer_address.country_code | t}}',
    user_agent: navigator.userAgent
  });

  // Product Arrow Click
  $('#product-thumbs-slider-nav-next, #product-thumbs-slider-nav-prev').click(function() {
    woopra.track('Arrow Click', { section: "Product" });
  });
</script>