<section class="cta-section">
  <div class="container product-container">
    <div class="product-thumbnails">
      <div class="product-slider">
        <div class="sliders-group">
          <div class="main-slider">
            <div id="product-main-slider-sc" class="swiper">
              <div class="swiper-wrapper">
                <div class="swiper-slide">
                  <div class="product-img">
                    <div class="img-wrap">
                      <img src="{{ "product-aio-product-thumbnail-0.png" | asset_url }}" alt="" loading="lazy">
                    </div>
                  </div>
                </div>
                {% for i in (1..5) %}
                  <div class="swiper-slide">
                    <img class="main-slider-vector-bg" src="{{ 'product-aio-vector-product-slider.png' | asset_url }}" alt="">
                    <div class="product-img">
                      <div class="img-wrap">
                        <img src="{{ "product-aio-product-thumbnail-" | append: i | append: ".png" | asset_url }}" alt="" loading="lazy">
                      </div>
                    </div>
                  </div>
                {% endfor %}
                <div class="swiper-slide">
                  <div class="product-video">
                    <iframe id="product-video-iframe" src="https://player.vimeo.com/video/365492409?playsinline=0" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen loading="lazy"></iframe>
                  </div>
                </div>
                {% for image in product.images %}
                  <div class="swiper-slide">
                    {% if shop.name == "CuraLife Global" %}
                      <img class="main-slider-vector-bg" src="{{ 'product-aio-vector-product-slider.png' | asset_url }}" alt="">
                    {% endif %}
                    <div class="product-img">
                      <div class="img-wrap">
                        <img src="{{ image.src | image_url }}" alt="{{ image.alt | escape }}" loading="lazy">
                      </div>
                    </div>
                  </div>
                {% endfor %}
              </div>
              <div class="swiper-pagination"></div>
            </div>
            <div id="product-main-slider-nav-prev" class="swiper-button-prev nav"></div>
            <div id="product-main-slider-nav-next" class="swiper-button-next nav"></div>
          </div>

          <div class="thumbs-slider">
            <div id="product-thumbs-slider-sc" class="swiper">
              <div class="swiper-wrapper">
                <div class="swiper-slide">
                  <div class="thumbs-img">
                    <div class="img-wrap">
                      <img src="{{ "product-aio-product-thumbnail-0.png" | asset_url }}" alt="" loading="lazy">
                    </div>
                  </div>
                </div>
                {% for i in (1..5) %}
                  <div class="swiper-slide">
                    <div class="thumbs-img">
                      <div class="img-wrap">
                        <img src="{{ "product-aio-product-thumbnail-" | append: i | append: ".png" | asset_url }}" alt="" loading="lazy">
                      </div>
                    </div>
                  </div>
                {% endfor %}
                <div class="swiper-slide">
                  <div class="thumbs-img video-thumbnail">
                    <div class="img-wrap">
                      <img src="{{ "product-aio-product-video-thumbnail.png" | asset_url }}" alt="" loading="lazy">
                    </div>
                  </div>
                </div>
                {% for image in product.images %}
                  <div class="swiper-slide">
                    <div class="thumbs-img">
                      <div class="img-wrap">
                        <img src="{{ image.src | image_url }}" alt="{{ image.alt | escape }}" loading="lazy">
                      </div>
                    </div>
                  </div>
                {% endfor %}
              </div>
            </div>
            <div id="product-thumbs-slider-nav-prev" class="swiper-button-prev"></div>
            <div id="product-thumbs-slider-nav-next" class="swiper-button-next"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="product-info">
      <div class="sub-title">
        <h1>{% if product.metafields.my_fields.alternative_title.value %}{{ product.metafields.my_fields.alternative_title.value }}{% else %}{{ product.title }}{% endif %}</h1>
      </div>
      <div class="rating-stars">
        <img class="rating-stars-img" src="{{ 'product-aio-rating-stars.png' | asset_url }}" alt="">
        <span class="reviews-quantity">3000+ Reviews</span>
      </div>
      <div class="quotes">
        <p class="quote">“It’s completely changed my life” - Paul M.</p>
        <p class="quote">“I’m healthier now than I’ve been in years” - D’Gay F.</p>
        <p class="quote">“Here’s my proof - my MD is thrilled. I’m a believer!” - Ilyssa E.</p>
      </div>
    </div>
    <div class="product-actions">
      <div class="form-wrap">
        <div id="CTAForm">
          <p class="cta-title">Select Your Pack</p>
          <div class="input-field product-option-select">
            {% for var in product.variants %}
              {% if var.title contains "CuraEats" %}
                {% assign bundle_addition = challange_value | plus: curaeats_value | times: 100 %}
                <div class="variant-notice"><p><b>Bonus</b> - CuraEats App <b>(<span class="rounded no-letters">{{ bundle_addition | money_with_currency | replace: ".00", "" | replace: "GBP", "" | replace: "AUD", "" | replace: "CAD", "" }}</span> value)</b></p></div>
              {% else %}
                {% assign bundle_addition = 0 %}
              {% endif %}
              <div class="variant-box">
                <div class="radio-box">
                  {% if var.compare_at_price > var.price %}
                    {% assign original_discount = var.compare_at_price | minus: var.price | divided_by: 100 %}
                    {% assign bundle_addition_real = bundle_addition | divided_by: 100 %}
                    {% assign discount = original_discount | plus: bundle_addition_real %}
                  {% else %}
                    {% assign discount = 0 %}
                  {% endif %}
                  <input type="radio" name="pack" value="{{ var.id }}" price="{{ var.price | money_without_currency }}" discount="{{ discount | replace: ".00", "" }}" title="{{ var.title }}" sku="{{ var.sku }}" save="{{var.metafields.my_fields.discount_percents}}" index="{{ product.variants.size | minus: forloop.index  | plus: 1 }}"></input>
                </div>
                <div class="variant-info">
                  <p class="variant-title">{{ var.title }}</p>
                  <div class="variant-infos">
                    <p class="subtitle">{{ var.metafields.my_fields.subtitle }}</p>
                  </div>
                </div>
                <div class="price {% if forloop.index == 3 %}last{% endif %}">
                  <p class="compared-at-price"><strike class="rounded no-letters">{{ var.compare_at_price | plus: bundle_addition | money_without_trailing_zeros }}</strike></p>
                  <p class="real-price rounded no-letters">{{ var.price | money_without_trailing_zeros }}</p>
                </div>
              </div>
            {% endfor %}
          </div>

          <input id="productVaraintSelected" type="hidden" name="id" value="{{ product.variants.first.id }}"/>
          <div class="submit-wrap">
            <div class="qty-data" style="display:none">
              <div class="qty-control">
                <a data-act="-" href="javascript:void(0)">
                  <span class="icon-minus"></span>
                </a>
                <label>
                  <input maxlength="4" name="quantity" type="number" value="1">
                </label>
                <a data-act="+" href="javascript:void(0)">
                  <span class="icon-plus"></span>
                </a>
              </div>
            </div>

            <div class="btn">
              <button class="main-btn" id="buy-button"><span>Shop Now</span> <span class="save" id="save" style="color: white"></span></button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  {% render 'trust-badges-section' %}
</section>

<style>
  .variant-notice p {
    background: #4B643D;
    color: white;
    padding: 4px;
    margin: unset;
  }

  @media screen and (max-width: 768px) {
    .product-template-all-in-one .cta-section .product-container .product-actions .form-wrap #CTAForm .variant-box .price.last {
      top: 9vw;
    }

    .product-template-all-in-one .cta-section .product-container .product-actions .form-wrap #CTAForm .variant-box .variant-info .variant-infos p {
      font-size: 12px !important;
    }
    .product-template-all-in-one .cta-section .product-container .product-actions .form-wrap #CTAForm .variant-box .variant-info .variant-title {
      font-size: 18px !important;
    }
  }
</style>

<style>
  .product-template-all-in-one .cta-section .product-container .product-info {
      max-height:120px;

}

@media screen and (max-width: 760px)  {
  .product-template-all-in-one .cta-section .product-container .product-info {
      max-height:41vw;

  }
}
</style>




<script>
  productThumbsAllInOne = new Swiper('#product-thumbs-slider-sc', {
    slidesPerView: 4,
    spaceBetween: 10,
    watchSlidesVisibility: true,
    grabCursor: true,
    loop: false,
    navigation: {
      nextEl: '#product-thumbs-slider-nav-next',
      prevEl: '#product-thumbs-slider-nav-prev',
      disabledClass: 'disabled'
    },
    breakpoints: {
      760: {
      slidesPerView: 1,
      },
      1080: {
      slidesPerView: 2,
      },
      1200: {
      slidesPerView: 3,
      },
      1400: {
      slidesPerView: 4,
      }
    }
  });

  productSliderAllInOne = new Swiper('#product-main-slider-sc', {
    slidesPerView: 1,
    spaceBetween: 15,
    centeredSlides: true,
    watchSlidesVisibility: false,
    loop: false,
    slideToClickedSlide: true,
    thumbs: {swiper: productThumbsAllInOne},
    breakpoints: {
      0: {
        pagination: {
          el: '.product-slider .swiper-pagination',
          clickable: 'true',
          type: 'bullets',
        },
        navigation: {
          nextEl: '#product-main-slider-nav-next',
          prevEl: '#product-main-slider-nav-prev',
          disabledClass: 'disabled'
        }
      },
      760: {
        pagination: {},
        navigation: {}
      }
    }
  });

  productSliderAllInOne.on('slideChange', function () {
      $('iframe#product-video-iframe').attr( 'src', function ( i, val ) { return val; });
    });

    let isFirstClick = true;
    jQuery(".variant-box").click(function() {
        if (isFirstClick) {
            isFirstClick = false;
        }
        else {
            // Slide to Variant Image
            let slideIndex = productSliderAllInOne.slides.length - jQuery('input[name=pack]:checked', '#CTAForm').attr('index');
            productSliderAllInOne.slideTo(slideIndex);

            // Track in GA
            window.dataLayer = window.dataLayer || [];
            window.dataLayer.push({
              'event': 'variant-click',
              'label': $('input[name=pack]:checked', '#CTAForm').attr('sku'),
              'userId': '{{ customer.id }}',
              'email': '{{ customer.email }}',
              'country': '{{customer.customer_address.country_code }}',
              'city': '{{customer.customer_address.city }}',
              'name': '{{ customer.first_name }}',
              'surname': '{{ customer.last_name }}',
              'phone_number': '{{customer.phone }}',
              'state': '{{customer.customer_address.province }}',       //state or province
              'zip': '{{customer.customer_address.zip }}'         //ZIP or Postal code
            });

            // Track in Woopra
            woopra.track('Product_Variant_Select', {
              sku: $(this).find("input").attr("sku"),
              variant_id: $(this).find("input").attr("value"),
              variant_title: $(this).find("input").attr("title"),
              price: $(this).find("input").attr("price")
            })
        }
    });

  reviewsSliderAllInOne = new Swiper('.product-template-all-in-one .reviews-section .swiper', {
      slidesPerView: 'auto',
      spaceBetween: 30,
      watchSlidesVisibility: false,
      centeredSlides: true,
      loop: true,
      slideToClickedSlide: true,
      navigation: {
          nextEl: '.reviews-section .swiper-button-next',
          prevEl: '.reviews-section .swiper-button-prev',
          disabledClass: 'disabled'
      },
      breakpoints: {
          760: {
              slidesPerView: 3,
          },
          1200: {
              slidesPerView: 5,
          }
      }
  });

  faqIngredientsMainSliderAllInOne = new Swiper('.product-template-all-in-one .faq-section .ingredients-main-slider.swiper', {
      slidesPerView: 1,
      spaceBetween: 15,
      watchSlidesVisibility: false,
      loop: false,
      autoHeight: true,
      slideToClickedSlide: true,
      navigation: {
          nextEl: '.faq-section .swiper-button-next',
          prevEl: '.faq-section .swiper-button-prev',
          disabledClass: 'disabled'
      }
  });
</script>



